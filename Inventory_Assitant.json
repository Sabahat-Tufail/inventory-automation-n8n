{
  "name": "Inventory_Assitant",
  "nodes": [
    {
      "parameters": {
        "public": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        0,
        0
      ],
      "id": "7da601b9-c3cf-41b7-b423-2c549049d5c2",
      "name": "When chat message received",
      "webhookId": "071ad4dd-becb-4188-ab0d-e0e283e9519d"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I",
          "mode": "list",
          "cachedResultName": "n8n test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        704,
        224
      ],
      "id": "0edb7cf5-a8d6-48e8-aa56-f4230c7c728a",
      "name": "Inventory",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "kxcRYdB5a8TD4Pxc",
          "name": "Google Sheets account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I",
          "mode": "list",
          "cachedResultName": "n8n test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Product": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Product__using_to_match_', ``, 'string') }}",
            "Stock": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Stock', ``, 'string') }}"
          },
          "matchingColumns": [
            "Product"
          ],
          "schema": [
            {
              "id": "Product",
              "displayName": "Product",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Stock",
              "displayName": "Stock",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        832,
        224
      ],
      "id": "22d9cc63-d920-44a8-b0f4-aaf156eb1896",
      "name": "update_inventory",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "kxcRYdB5a8TD4Pxc",
          "name": "Google Sheets account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I",
          "mode": "list",
          "cachedResultName": "n8n test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qoUmbBcLvvYuzZrBpmqaYty_OZ8yHy9U7tKvOpi8T2I/edit#gid=0"
        },
        "startIndex": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start_Row_Number', ``, 'number') }}",
        "numberToDelete": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Number_of_Rows_to_Delete', ``, 'number') }}"
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        960,
        224
      ],
      "id": "2e268b93-6623-4cc6-b603-94e9a06b5c2c",
      "name": "Deleteitem",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "kxcRYdB5a8TD4Pxc",
          "name": "Google Sheets account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return items.map(item => {\n  if (item.json.chatInput) {\n    item.json.chatInput = item.json.chatInput\n      .split(\" \")\n      .map(word =>\n        word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()\n      )\n      .join(\" \");\n  }\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        224,
        0
      ],
      "id": "98bb0e3d-e854-48a9-bfb0-1f3e7edcbc5a",
      "name": "normalizer"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        448,
        224
      ],
      "id": "992ddd87-861a-4b1e-93b7-4ff1e308d622",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "fxOBTGBAIVQXxhcE",
          "name": "Google Gemini(PaLM) Api account 2"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        576,
        224
      ],
      "id": "bbbd2d05-6c69-4a0a-9b64-836eb7082c69",
      "name": "Simple Memory1"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "= * You are an **Inventory Assistant**.\n\nUnique Item Count\n\nOnly when specifically asked \"how many items are in inventory?\" or \"how many products are in inventory?\":\n\nCall the \"inventory\" tool to get all data\nExtract all \"Product \" values from the response\nCreate an array of unique products (remove duplicates)\nCount the length of this unique array\nRespond exactly as: \"There are X unique items in the inventory.\"\n\n**Product Queries (e.g., “How many printers?”)**\n\n* Search `products[]` for matching product(s).\n* Respond with **product name(s)** and **exact stock value(s)**.\n* If product not found → respond:\n\n  * **“This product is not available in the inventory.”**\n* If duplicates exist → return each separately.\n\n---\n\n**Out of Stock**\n\n* List only products where **Stock = 0**.\n* If none → respond:\n\n  * **“No items are out of stock.”**\n\n---\n\n**Filter Queries**\n\n* **Less than (n):** list products where Stock < n.\n* **Greater than (n):** list products where Stock > n.\n* **Equal to (n):** list products where Stock = n.\n* **Between (n1, n2):** list products where Stock is in the range \\[n1, n2].\n\n---\n\n**List All Products**\n\n* Return full `products[]` with **Product** and **Stock**.\n\n---\n\n**Updates & Deletions**\n\n* To update stock → call `update-inventory` node with:\n\n  ```json\n  { \"Product\": \"<name>\", \"Stock\": <new_value> }\n  ```\n* To delete → call `DeleteItem` node with:\n\n  ```json\n  { \"Start_Row_Number\": <row index>, \"Number_of_Rows_to_Delete\": 1 }\n  ```\n* Always ensure correct row index is passed.\n\n---\n\n**Greetings or Empty Messages**\n\n* If user sends greetings like **“hi”** or symbols like **\\[]\\[]**, respond politely without changing inventory.\n* Example:\n\n  * **“Hello! How can I assist you with your inventory today?”**\n\n\nDisplay All answers on UI\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        704,
        0
      ],
      "id": "b6edfb1d-50df-4b30-9d75-a6e95b96c174",
      "name": "AI Agent"
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "normalizer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Inventory": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "update_inventory": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Deleteitem": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "normalizer": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory1": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "a0c19644-abad-4b64-9571-63d0475d1968",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "0bb9f7c0e1818fb2e563aff2759a42429ab87f78852434cde9cc9dd51d2870bb"
  },
  "id": "i9hUmh9yyaR9wrdS",
  "tags": []
}